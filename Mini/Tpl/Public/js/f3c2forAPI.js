var touchid=854,getBarcode="",isAngle=2,def_Modeltype="",def_modelcolor="",def_modelhead=0,GetHistoryClothesArr=[],beubeu_prefix_url="http://new.beubeu.com",beubeu_zoom=1,beubeu_key="8f1a6e3f182904ad22170f56c890e533",beubeu_levelarray=[15608,15609,15610,15611,15612,15613,15614,15615,15616,15617,15618,15619,15620,15621,15623,15624,15625,15622,15626,15627,15628,15629,15630,15631,15632,15633,15634,15635,15636,15637,15638,15639,15640,15641,15642,15643,15644,15645,15646,15647,15648,15649,15650,15842,15651,
15652,15653,15654,15655,15656,15657,15658,15659,15660,15661,15662,15663,15664,15665,15666,15667,15668,15669,15670,15671,15672,15673,15674,15675,15676,15677,15678,15679,15680,15681,15682,15683,15684,15685,15686,15687,15688,15689,15690,15691,15692,15693,15694,15695,15696,15697],beubeu_timCheck=1E3,clothes_id=[],clothes_key=[],clothes_key2=[],arr_clothes_id=[15611,15612,15676,15675],arr1_lv=[15611,15612,15676,15675];Model=new ModelClass;
function loadMymodel(d,a){touchid=d;beubeu_key=a;Model.GetModel()}
function load_dp_img(d,a,f){if(1!=f&&2!=f){clothes_key2=[];f=0;var c="",e="",b;for(b in beubeu_levelarray)beubeu_levelarray[b]==a&&(f=b);var h=0;for(b in beubeu_levelarray)for(var g in arr1_lv)beubeu_levelarray[b]==arr1_lv[g]&&parseInt(b)<parseInt(f)&&(h+=1);arr_clothes_id.splice(h,0,d);arr1_lv.splice(h,0,a);for(b in arr_clothes_id)15611!=arr_clothes_id[b]&&15612!=arr_clothes_id[b]&&15676!=arr_clothes_id[b]&&15675!=arr_clothes_id[b]&&(""==c?(c=arr_clothes_id[b],e=b):(c=c+","+arr_clothes_id[b],e=e+
","+b))}else if(1==f)c=d,e=a;else if(2==f)for(b in e=c="",arr_clothes_id)15611!=arr_clothes_id[b]&&15612!=arr_clothes_id[b]&&15676!=arr_clothes_id[b]&&15675!=arr_clothes_id[b]&&(""==c?(c=arr_clothes_id[b],e=b):(c=c+","+arr_clothes_id[b],e=e+","+b));""!=c&&","==c.substr(c.length-1)&&(c=c.substring(0,c.length-1),e=e.substring(0,e.length-1));if(0==d&&0==a||""==c&&""==e)e=c=0;$.getJSON(beubeu_prefix_url+"/api/getdapei?key="+beubeu_key+"&touchid="+touchid+"modelcolor="+def_modelcolor+"&modeltype="+def_Modeltype+
"&clothesid="+c+"&level="+e+"&heair="+def_modelhead+"&callback=?",function(a){if("ok"==a.status){for(var b in a.info.getbclothesinfo)Model.CurrClothesArray.push(new ClothesList(a.info.getbclothesinfo[b].id,a.info.getbclothesinfo[b].name,a.info.getbclothesinfo[b].level,a.info.getbclothesinfo[b].price,a.info.getbclothesinfo[b].discountprice,a.info.getbclothesinfo[b].brandname,a.info.getbclothesinfo[b].colorcode,a.info.getbclothesinfo[b].colorimage));Model.show(a.info.url)}"error"==a.status&&(0==a.info?
setTimeout(function(){load_dp_img(c,e,1)},beubeu_timCheck):$("#beubeu_loadImg").text(a.info))})}function History(d,a,f){GetHistoryClothesArr=[];for(var c in d)if(null!=d[c]&&null!=d[c].ID)if(0<GetHistoryClothesArr.length){a=0;for(var e in GetHistoryClothesArr)GetHistoryClothesArr[e].ID==d[c].ID&&a++;0==a&&GetHistoryClothesArr.push(d[c])}else GetHistoryClothesArr.push(d[c])}
function ClothesList(d,a,f,c,e,b,h,g){this.ID=d;this.Title=a;this.Level=f;this.Price=c;this.Discountprice=e;this.Brandname=b;this.Colorcode=h;this.Colorimage=g}
function ModelClass(){this.StopAutoRunCallback=this.CurrClothesCallback=this.HistoryCallback=null;this.AutoRunStatus=!1;this.NotModelListCallBack=this.SaveImageSucceedCallBack=null;this.MAXHISTORY=20;this.CurrHistory=0;this.MAXCURR=90;this.CurrClothesArray=[];this.ClothesHistoryArray=[];this.LastClothes=null;this.Angle=0;this.AngleString="00";for(var d=0;d<this.MAXHISTORY;d++)this.ClothesHistoryArray[d]=new ClothesList(null,null,null,null,null,null,null,null);for(d=0;d<this.MAXCURR;d++)this.CurrClothesArray[d]=
new ClothesList(null,null,null,null,null,null,null,null);this.GetModel=function(){$.getJSON(beubeu_prefix_url+"/api/getinitialmodel?key="+beubeu_key+"&touchid="+touchid+"&callback=?",function(a){"ok"==a.status&&(def_Modeltype=a.info.modeltype,def_modelhead=a.info.heair,Model.show(a.info.url));"error"==a.status&&(0==a.info?setTimeout(function(){Model.GetModel()},beubeu_timCheck):$("#beubeu_loadImg").text(a.info))})};this.GetAllModel=function(){$.getJSON(beubeu_prefix_url+"/api/getmodellimitimg?key="+
beubeu_key+"&touchid="+touchid+"&callback=?",function(a){"ok"==a.status&&getAllModel_callback(a);if("error"==a.status)return a.info})};this.Changemodeltype=function(a,f){$.getJSON(beubeu_prefix_url+"/api/modelchange?key="+beubeu_key+"&touchid="+touchid+"&modelcolor="+f+"&modeltype="+a+"&callback=?",function(c){"ok"==c.status&&(def_Modeltype=c.info.modeltype,def_modelhead=c.info.heair,Model.show(c.info.url));"error"==c.status&&(0==c.info?setTimeout(function(){Model.Changemodeltype(a,f)},beubeu_timCheck):
$("#beubeu_loadImg").text(c.info))})};this.DressingByBarcode=function(a){Model.Dressing(a)};this.Dressing=function(a){null!=a&&""!=a&&$.getJSON(beubeu_prefix_url+"/api/onepiececlothes?key="+beubeu_key+"&touchid="+touchid+"&id="+a+"&callback=?",function(a){var c=0,e=0;if("ok"==a.status){for(var b in a.info)c=a.info[b].id,e=a.info[b].level;var d=-1,g=-1;for(b in arr1_lv)arr1_lv[b]==e&&arr_clothes_id[b]==c&&(d=b),arr1_lv[b]==e&&arr_clothes_id[b]!=c&&(g=b);-1<d&&(arr1_lv.splice(d,1),arr_clothes_id.splice(d,
1));-1<g&&(arr_clothes_id[g]=c);-1<d||-1<g?load_dp_img(c,e,2):load_dp_img(c,e)}"error"==a.status&&alert(a.info)})};this.GetAngel=function(){return this.Angle};this.SetAngel=function(a){this.Angle=a;this.show()};this.Empty=function(a){load_dp_img(0,0)};this.GetCurrClothesArr=function(){Model.GetCurrClothes();return[]};this.GetCurrClothes=function(){return this.CurrClothesArray};this.GetHistoryClothesArray=function(){return GetHistoryClothesArr};this.showclothesdetail=function(a){};this.dapei1=function(a){};
this.show=function(a){$("#beubeu_loadImg").text("loadimg...");var d=$("#beubeu_loadImg").width(),c=$("#beubeu_loadImg").height();load_image=new Image;load_image.src=a;load_image.onload=function(){var e=load_image.width,b=load_image.height;d>c&&(beubeu_zoom=b/c);c>d&&(beubeu_zoom=e/d);e/=beubeu_zoom;b/=beubeu_zoom;$("#beubeu_loadImg").text("");$("#beubeu_loadImg").append("<div style='width:100%;height:100%;'><div style='width:100%;height:100%;position:relative;'><img src=\""+a+"."+Math.ceil(parseInt(e))+
"x"+Math.ceil(parseInt(b))+'.png" width="'+Math.ceil(parseInt(e))+'px" height="'+Math.ceil(parseInt(b))+'px" /></div></div>')}}};